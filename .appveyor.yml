platform:
- x64
environment:
  nodejs_version: "6"
  GITHUB_TOKEN:
    secure: t1s7bP+lo6z4Gv+F0J2pvD4KY2nzgdtOtrz/eN3Q41XgoV4+GnBtuY2oHQdQJ1nH
cache:
- '%APPDATA%\npm-cache'
- '%USERPROFILE%\.electron'
branches:
  only:
  - master
install:
- ps: Install-Product node $env:nodejs_version $env:platform
- set PATH=%APPDATA%\npm;%PATH%
- npm install

test_script:
- node --version
- npm --version
- npm test

build_script:
- mkdir out
- cd out
- git clone https://github.com/electron-userland/electron-forge.git
- cd electron-forge
- git checkout publish-cmd
- npm install
- npm link
- cd ../..
- echo %APPVEYOR_REPO_TAG%
- If %APPVEYOR_REPO_TAG% == "true" electron-forge publish
